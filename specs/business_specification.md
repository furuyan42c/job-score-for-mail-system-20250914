# バイト求人マッチングシステム ビジネス仕様書

## 1. システム概要

### 1.1 サービス概要
本システムは、10万件のバイト求人データベースから、1万人の会員それぞれに最適な40件を毎日自動選定し、パーソナライズされたメールを配信するマッチングサービスです。

### 1.2 ビジネス目標
- **応募率向上**: パーソナライズ配信により応募率30%向上を目指す
- **配信効率化**: 1万通/日の完全自動配信を実現
- **継続率向上**: 的確なマッチングによる配信停止率の低減

### 1.3 システムの特徴
1. **AI活用のスコアリング**: SEMRushキーワードデータを活用した求人評価
2. **行動ベースのパーソナライゼーション**: 応募履歴から好みを学習
3. **多様性確保**: 偏りのない40件の選定
4. **LLM活用**: 魅力的なメール文面の自動生成

## 2. 配信メール構成

### 2.1 配信スケジュール
- **配信時刻**: 毎朝6:00
- **配信頻度**: 1日1回（ユーザー設定により週次も可能）
- **配信件数**: 1ユーザーあたり40件の求人情報

### 2.2 メール構成要素

#### メールヘッダー
- 配信日付
- ユーザー名（応募時の登録名）
- 活動エリア（応募履歴から推定）

#### 本文セクション
1. **おすすめ求人TOP5**（詳細表示）
   - 時給、勤務時間、特典を強調
   - ワンクリック応募リンク付き

2. **エリア別求人TOP10**
   - 応募頻度の高い都道府県の求人

3. **近隣求人TOP10**
   - 応募頻度の高い市区町村の求人

4. **お得バイトTOP10**
   - 日払い、高時給などの特典求人

### 2.3 配信文面サンプル
```
━━━━━━━━━━━━━━━━━━━━━━━━
📧 ゲットバイト通信　2025年7月15日号
━━━━━━━━━━━━━━━━━━━━━━━━
※本メールは「ゲットバイト」にご登録の
直己 様（東京都小金井市エリアで活動中）にお届けしています。

こんにちは、ゲットバイト編集部です！
本日の超おすすめ40求人をお届けします。
```

## 3. データベース構造

### 3.1 主要データグループ

#### マスターデータ
- 都道府県・市区町村マスター（位置情報付き）
- 職種分類マスター（大中小分類）
- 雇用形態マスター（アルバイト、パート等）
- 給与タイプマスター（時給、日給、月給等）
- 求人特徴マスター（未経験歓迎等の条件）
- ニーズカテゴリーマスター（14種類）

#### 求人データ
- 求人詳細情報（385項目）
- マッチング用軽量データ
- 表示用コンテンツデータ
- スコアリング結果データ

#### キーワード・スコアリング
- SEMRushキーワードデータ
- キーワードスコアリングルール

#### ユーザー関連
- ユーザー基本情報
- ユーザープロファイル（応募傾向の自動集計）
- 行動履歴（開封、クリック、応募）
- ユーザー×求人マッピング

#### 配信管理
- 日次選定求人リスト
- メール配信キュー
- 配信ステータス管理

## 4. カテゴリー分類システム

### 4.1 ニーズベースカテゴリー（14種類）

求人は以下のニーズカテゴリーに自動分類され、複数のカテゴリーに属することが可能です。

| カテゴリー名 | 対象者 | 判定方法 |
|------------|---------|----------|
| 日払い・週払い | すぐに給料が必要な人 | キーワード自動検出 |
| 短期・単発OK | 短期間だけ働きたい人 | キーワード＋雇用期間 |
| 高時給 | 効率よく稼ぎたい人 | 地域平均の120%以上 |
| シフト自由 | 自分のペースで働きたい人 | キーワード検出 |
| 未経験歓迎 | 初めてバイトする人 | 特徴コード＋キーワード |
| 在宅・リモート | 通勤したくない人 | キーワード検出 |
| 学生歓迎 | 学業と両立したい人 | 特徴コード |
| 高校生歓迎 | 高校生 | 年齢条件＋キーワード |
| 主婦歓迎 | 家事・育児と両立したい人 | キーワード＋時間帯 |
| シニア歓迎 | 60歳以上の人 | 年齢上限＋キーワード |
| 土日のみOK | 週末だけ働きたい人 | キーワード検出 |
| 副業・WワークOK | 掛け持ちしたい人 | キーワード検出 |
| 交通費支給 | 交通費を節約したい人 | キーワード検出 |
| 即日勤務OK | すぐに働きたい人 | キーワード検出 |

### 4.2 職種カテゴリー（12種類）

各求人は1つの職種カテゴリーに分類されます。

- 飲食・フード系（ホール、キッチン、カフェ等）
- 販売・サービス系（アパレル、コンビニ、スーパー等）
- 配送・ドライバー系（宅配、デリバリー等）
- オフィスワーク系（事務、データ入力等）
- 医療・介護・保育系
- 軽作業・工場系
- 美容・理容系
- 教育系（塾講師、家庭教師等）
- エンタメ系
- イベント・キャンペーン系
- IT・クリエイティブ系
- その他

### 4.3 カテゴリー分類の改善機能

#### 検索精度向上
- 9つのデータフィールドから総合判定
- 否定パターンの自動除外（「日払い不可」等を除外）
- 複合条件での判定（主婦歓迎＝キーワード＋勤務時間帯）

#### 信頼度スコア
- 各カテゴリーマッチの確からしさを0-100で評価
- キーワード出現位置、回数、関連データでの裏付けを考慮

## 5. スコアリングシステム

### 5.1 基本スコアの構成（0-999,999点）

求人の魅力度を以下の6要素で総合評価します。

| 評価要素 | 配分 | 評価内容 |
|---------|------|----------|
| キーワードマッチ | 35% | SEMRushの人気検索キーワードとの一致度 |
| 求人特徴 | 25% | 未経験歓迎、交通費支給等の人気条件 |
| 給与競争力 | 20% | 地域・職種別の相対的な給与水準 |
| 掲載新鮮度 | 10% | 新着求人や締切までの期間 |
| 立地利便性 | 5% | 駅からの距離、主要駅かどうか |
| 企業評価 | 5% | 過去の応募実績、掲載頻度 |

### 5.2 カテゴリー別ブースト係数

需要の高いカテゴリーにはスコアブーストを適用：

- **高時給**: 1.5倍
- **在宅・リモート**: 1.4倍
- **配送・ドライバー系**: 1.3倍
- **日払い・週払い**: 1.3倍
- **医療・介護・保育系**: 1.4倍

### 5.3 動的ブースト

配信タイミングに応じた調整：
- **朝の配信**: 即日勤務可能な求人を優遇
- **週末前**: 土日勤務の求人を優遇  
- **夏季・年末**: 短期求人を優遇

## 6. パーソナライゼーション

### 6.1 ユーザープロファイリング

**応募履歴からの自動学習**
- 最初の1件の応募から配信開始
- 応募のたびに精度が向上
- 居住地情報は取得せず、応募エリアから推定

**学習する要素**
- 活動エリア（都道府県・市区町村）
- 希望職種
- 希望給与レンジ
- 重視する条件（日払い、シフト自由等）

### 6.2 パーソナライズドスコア

基本スコアをユーザーの好みで調整（最大2倍）：

| マッチ要素 | 影響度 | 判定方法 |
|-----------|--------|----------|
| 地域マッチ | 40% | 過去の応募エリアとの一致 |
| 職種マッチ | 30% | 過去の応募職種との一致 |
| 給与マッチ | 15% | 応募実績の給与帯との適合 |
| 特徴マッチ | 10% | 重視する条件との一致 |
| カテゴリーマッチ | 5% | 好みのカテゴリーとの一致 |

### 6.3 フィルタリング機能

#### 除外ルール
- 3回以上応募して不採用の企業
- 配信しても一度も開封しないカテゴリー
- ユーザーの応募実績から外れた給与帯

#### 多様性の確保
選定される40件の内訳制限：
- 同一カテゴリー：最大10件
- 同一職種：最大15件
- 同一地域：最大20件
- 上位10件は制限なし（高スコア優先）

## 7. システム処理フロー

### 7.1 日次バッチ処理スケジュール

| 時刻 | 処理名 | 処理内容 | 目標時間 |
|------|--------|----------|---------|
| 02:00 | データ収集 | 外部APIから求人データ取得・更新 | 30分 |
| 03:00 | スコアリング | 全求人のスコア計算・カテゴリー分類 | 45分 |
| 04:00 | マッチング | 1万ユーザー×40件の選定 | 60分 |
| 05:00 | メール生成 | LLMによる文面生成・キュー登録 | 30分 |
| 06:00 | 配信実行 | SendGrid/SES経由での一斉配信 | 120分 |

### 7.2 リアルタイム処理

- **応募データ受信**: ユーザープロファイルを即時更新
- **開封・クリック追跡**: 行動データをリアルタイム記録
- **配信停止**: 即座に配信リストから除外

## 8. システム構成

### 8.1 ディレクトリ構造
```
new.mail.score/
├── specs/                      # 仕様書
│   ├── ER/                     # ER図
│   │   └── ER_new_modified.mmd # データベース設計図
│   ├── specification.md        # 元仕様書
│   ├── system_specification_v2.md # 技術仕様書
│   └── business_specification.md  # 本ビジネス仕様書
│
├── src/                        # ソースコード
│   ├── batch/                  # バッチ処理
│   │   ├── batch_01_import_jobs.py
│   │   ├── batch_02_scoring.py
│   │   ├── batch_03_matching.py
│   │   ├── batch_04_email_generation.py
│   │   └── batch_05_send_emails.py
│   │
│   ├── api/                    # API実装
│   │   ├── scoring/            # スコアリングAPI
│   │   ├── matching/           # マッチングAPI
│   │   └── webhook/            # Webhook処理
│   │
│   ├── models/                 # データモデル
│   │   ├── job.py              # 求人モデル
│   │   ├── user.py             # ユーザーモデル
│   │   └── enrichment.py       # エンリッチメントモデル
│   │
│   ├── services/               # ビジネスロジック
│   │   ├── categorization/     # カテゴリー分類
│   │   ├── scoring/            # スコアリング
│   │   ├── personalization/    # パーソナライゼーション
│   │   └── email_generation/   # メール生成
│   │
│   └── utils/                  # ユーティリティ
│       ├── database.py         # DB接続
│       ├── cache.py            # キャッシュ管理
│       └── logger.py           # ログ出力
│
├── config/                     # 設定ファイル
│   ├── .env.development        # 開発環境設定
│   ├── .env.production         # 本番環境設定
│   └── categories.yaml         # カテゴリー定義
│
├── tests/                      # テスト
│   ├── unit/                   # 単体テスト
│   ├── integration/            # 統合テスト
│   └── fixtures/               # テストデータ
│
├── migrations/                 # データベースマイグレーション
│   └── sql/                    # SQLスクリプト
│
├── logs/                       # ログファイル
│
├── docker/                     # Docker設定
│   ├── Dockerfile
│   └── docker-compose.yml
│
└── README.md                   # プロジェクト説明書
```

### 8.2 技術スタック
- **言語**: Python 3.11以上
- **データベース**: PostgreSQL 15（Supabase）
- **キャッシュ**: Redis
- **メール配信**: SendGrid / Amazon SES
- **LLM API**: OpenAI GPT-4 / Claude API
- **監視**: Grafana + Prometheus

## 9. パフォーマンス要件

### 9.1 処理速度目標
- **求人インポート**: 10万件を30分以内
- **スコアリング**: 10万件を45分以内
- **マッチング**: 1万ユーザーを60分以内
- **メール生成**: 1万通を30分以内
- **配信完了**: 1万通を120分以内

### 9.2 システム負荷
- **同時処理**: 8並列処理
- **メモリ使用**: 最大16GB
- **DB接続数**: 最大100接続
- **API呼び出し**: 100リクエスト/秒

## 10. 監視・運用

### 10.1 監視項目
- **バッチ処理**: 実行時間、エラー率、処理件数
- **配信状況**: 送信成功率、開封率、クリック率
- **システム**: CPU使用率、メモリ使用率、DB接続数
- **ビジネス**: 応募率、配信停止率、アクティブユーザー数

### 10.2 アラート設定

| レベル | 条件 | 対応 |
|--------|------|------|
| 緊急 | バッチ処理2時間以上遅延 | 即時対応 |
| 警告 | 配信成功率95%未満 | 1時間以内対応 |
| 注意 | DB接続数90%超過 | 監視強化 |

### 10.3 バックアップ
- **データベース**: 日次フルバックアップ、6時間ごと差分
- **ログ**: 90日間保存後アーカイブ
- **設定**: Git管理によるバージョン管理

## 11. セキュリティ考慮事項

### 11.1 データ保護
- 個人情報の暗号化保存
- メールアドレスのハッシュ化
- アクセスログの定期削除（90日）

### 11.2 アクセス制御
- API認証（JWT）
- レート制限（100リクエスト/分）
- IP制限（本番環境）

### 11.3 監査
- 全操作のログ記録
- 定期的なセキュリティ監査
- 脆弱性診断の実施

## 12. 今後の拡張計画

### Phase 1（現在）
- 基本的なスコアリング・マッチング
- 日次メール配信
- 応募追跡

### Phase 2（3ヶ月後）
- A/Bテスト機能
- プッシュ通知連携
- LINE配信対応

### Phase 3（6ヶ月後）
- リアルタイムマッチング
- AIチャットボット対応
- 企業向けダッシュボード

## 13. 成功指標（KPI）

### 13.1 主要指標
- **応募率**: 配信メールからの応募率5%以上
- **開封率**: 40%以上
- **クリック率**: 15%以上
- **配信継続率**: 3ヶ月後70%以上

### 13.2 サブ指標
- **パーソナライズ精度**: 推薦求人の応募率
- **処理効率**: バッチ処理の完了時間
- **システム稼働率**: 99.9%以上

## 14. 用語集

| 用語 | 説明 |
|------|------|
| エンドクライアント | 実際の求人募集企業 |
| クライアント | 求人媒体・求人代理店 |
| スコア | 求人の魅力度を0-999,999で数値化したもの |
| パーソナライズドスコア | ユーザーの好みを反映した調整後スコア |
| ニーズカテゴリー | ユーザーの働き方ニーズに基づく14分類 |
| 職種カテゴリー | 仕事内容による12分類 |
| 推定活動エリア | 応募履歴から推定されるユーザーの活動地域 |
| ブースト係数 | スコアを増幅する倍率（1.0-2.0） |

## 15. 改訂履歴

| 版数 | 日付 | 内容 |
|------|------|------|
| v1.0 | 2024-08-XX | 初版作成 |
| v2.0 | 2024-09-XX | パーソナライゼーション機能追加 |
| v3.0 | 2025-01-XX | カテゴリー分類改善、応募ベース配信対応 |

---

**本仕様書に関する問い合わせ先**
- プロジェクト責任者：[担当者名]
- 連絡先：[メールアドレス]
- 最終更新日：2025年1月